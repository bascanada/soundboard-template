<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Soundboard Admin</title>

<body>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <script>
        var ClipsPreview = createClass({
            render: function () {
                var entry = this.props.entry;
                var sources = entry.getIn(['data', 'sources']);

                // Helper to convert immutable structure to JS if needed, though standard map access works
                if (!sources) return h('div', {}, 'No sources defined');

                return h('div', {
                    style: {
                        padding: '20px',
                        fontFamily: 'sans-serif'
                    }
                },
                    h('h1', {
                        style: {
                            borderBottom: '2px solid #ddd',
                            paddingBottom: '10px'
                        }
                    }, 'Clips Configuration'),
                    sources.map(function (source, index) {
                        var clips = source.get('clips');
                        return h('div', {
                            key: index,
                            style: {
                                marginBottom: '30px',
                                background: '#f9f9f9',
                                padding: '15px',
                                borderRadius: '8px'
                            }
                        },
                            h('h3', {
                                style: {
                                    color: '#2c3e50',
                                    margin: '0 0 10px'
                                }
                            }, 'Source: ' + (source.get('videoUrl') || 'No URL')),
                            h('div', {
                                style: {
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fill, minmax(250px, 1fr))',
                                    gap: '15px'
                                }
                            },
                                clips ? clips.map(function (clip, cIndex) {
                                    return h('div', {
                                        key: cIndex,
                                        style: {
                                            background: 'white',
                                            padding: '10px',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.1)',
                                            borderRadius: '4px'
                                        }
                                    },
                                        h('div', {
                                            style: {
                                                fontWeight: 'bold',
                                                fontSize: '1.1em'
                                            }
                                        }, clip.get('title') || 'Untitled'),
                                        h('div', {
                                            style: {
                                                margin: '5px 0'
                                            }
                                        },
                                            h('span', {
                                                style: {
                                                    background: '#ebf8ff',
                                                    color: '#2b6cb0',
                                                    padding: '2px 6px',
                                                    borderRadius: '4px',
                                                    fontSize: '0.8em',
                                                    textTransform: 'uppercase'
                                                }
                                            }, clip.get('category') || 'No Category')
                                        ),
                                        h('div', {
                                            style: {
                                                fontSize: '0.9em',
                                                color: '#666'
                                            }
                                        },
                                            h('span', {}, '‚è± ' + clip.get('start') + ' - ' + clip.get('end')),
                                            clip.get('scale') ? h('span', {
                                                style: {
                                                    marginLeft: '10px',
                                                    color: '#e53e3e'
                                                }
                                            }, 'üîç ' + clip.get('scale') + 'x') : null
                                        )
                                    );
                                }) : h('div', {}, 'No clips in this source')
                            )
                        );
                    })
                );
            }
        });

        CMS.registerPreviewTemplate("clips", ClipsPreview);
    </script>
</body>

</html>